{"version":3,"sources":["Home.js","Components/Reader/StorySelector.js","Components/Reader/Display.js","Components/Reader/CharacterImage.js","lib/replace.js","Reader.js","Editor.js","Images.js","App.js","reportWebVitals.js","index.js"],"names":["Home","to","pathname","SelectorWindow","styled","div","Background","ContentBox","Select","select","SelectButton","button","EPSelector","props","stories","story_table","main","filter","s","type","activity","mini_activity","memory","ep_id","story_id","ep","match","groups","value","onChange","selectEP","label","map","id","name","zh_CN","en_US","SubEPSelector","selectIndex","story","index","code","LanguageSelector","choices","lang_name","ja_JP","ko_KR","th_TH","selectLanguage","choice","sort","language","publisher","StorySelector","event","setState","target","a","Axios","get","encodeURI","backend","state","data","length","selected","find","c","this","setSelect","prevProps","onClick","close","selectStory","story_ep","story_index","story_language","React","PureComponent","MainDisplay","DescriptionBlock","DialogBlock","DialogName","DialogText","DecisionBlock","DecisionButton","css","BackgroundImage","img","Description","lines","line","text","lines_nums","Dialog","selectChar","char","Decision","params","options","option","i","values","Disply","decide","decision","prepare","result","background","char_img","tag","image","push","src","j","join","desc_id","last","references","includes","next","focus","name2","CharImage","CharacterImage","useState","setSrc","useEffect","num","split","SpriteHub","base","Object","keys","sprites","Image","onload","canvas","document","createElement","getContext","drawImage","FaceSize","x","y","toDataURL","mergeImages","FacePos","then","sprite","replace","source","translated","tagRE","dialogRE","decisionRE","blankRE","counter","obj","toUpperCase","key","v","trim","temp","forEach","param","search","Main","Nav","NavItems","NavItem","Content","Reader","getStoryData","sIndex","lang","status","file","String","ts","data_source","story_data","window","scrollTo","storyselector","getStoryList","re","sorted","b","name_a","act","parseInt","d","name_b","redirect","redirect_search","showCharImage","location","urlParams","URLSearchParams","getUrlParams","className","Display","toLowerCase","Editor","skins_list","require","chars_list","images_list","CatBackground","CatSearch","SearchBox","input","CatBody","NavContainer","NavButton","primary","CatContent","CharCard","CharImg","BackButton","Operators","setSearch","op","setOP","skinName","skin","skinGroupId","skinGroupName","onInput","e","href","skinId","rel","Characters","setChar","images","setImages","getImageSrc","c_name","n","promises","Promise","all","Backgrounds","backgrounds","bg","alt","Images","cat","setCat","App","basename","process","exact","path","component","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.c3c3d17b.chunk.js","sourcesContent":["import { Redirect } from \"react-router-dom\";\r\n\r\nexport default function Home() {\r\n  return (\r\n    <div>\r\n      <Redirect\r\n        to={{pathname: \"/reader\",}}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","import Axios from \"axios\";\r\nimport React from \"react\";\r\nimport styled from \"styled-components\";\r\n\r\nconst SelectorWindow = styled.div`\r\n  height: 100vh;\r\n  width: 100vw;\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  overflow: auto;\r\n`;\r\n\r\nconst Background = styled.div`\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  width: 100%;\r\n  height: 100%;\r\n  position: absolute;\r\n`;\r\n\r\nconst ContentBox = styled.div`\r\n  width: 80%;\r\n  background-color: white;\r\n  margin: 1rem auto;\r\n  padding: 1rem;\r\n  display: flex;\r\n  flex-direction: column;\r\n  position: relative;\r\n`;\r\n\r\nconst Select = styled.select`\r\n  width: 100%;\r\n  margin: 1rem 0;\r\n  padding: 0.25rem;\r\n`;\r\n\r\nconst SelectButton = styled.button`\r\n  background-color: #212121;\r\n  color: white;\r\n  border: solid 1px;\r\n  margin: 1rem 0;\r\n  padding: 0.25rem;\r\n`;\r\n\r\nconst EPSelector = (props) => {\r\n  const stories = props.story_table;\r\n  const main = stories.filter((s) => s.type === `main`);\r\n  const activity = stories.filter((s) => s.type === `activity`);\r\n  const mini_activity = stories.filter((s) => s.type === `mini_activity`);\r\n  const memory = stories.filter((s) => s.type === `memory`);\r\n  const ep_id = (story_id) => {\r\n    const { ep } = story_id.match(/main_(?<ep>[0-9])/).groups;\r\n    return `EP ${ep} : `;\r\n  };\r\n  const select = (\r\n    <Select value={props.value} onChange={props.selectEP}>\r\n      <option value=\"\">Select Episode</option>\r\n      <optgroup label=\"Main Story\">\r\n        {main.map((ep) => (\r\n          <option key={ep.id} value={ep.id}>\r\n            {ep_id(ep.id)} {ep.name.zh_CN}{\" \"}\r\n            {ep.name.en_US ? `(${ep.name.en_US})` : ``}\r\n          </option>\r\n        ))}\r\n      </optgroup>\r\n      <optgroup label=\"Activity Story\">\r\n        {activity.map((ep) => (\r\n          <option key={ep.id} value={ep.id}>\r\n            {ep.name.zh_CN} {ep.name.en_US ? `(${ep.name.en_US})` : ``}\r\n          </option>\r\n        ))}\r\n      </optgroup>\r\n      <optgroup label=\"Mini Activity Story\">\r\n        {mini_activity.map((ep) => (\r\n          <option key={ep.id} value={ep.id}>\r\n            {ep.name.zh_CN} {ep.name.en_US ? `(${ep.name.en_US})` : ``}\r\n          </option>\r\n        ))}\r\n      </optgroup>\r\n      <optgroup label=\"Character Memory\">\r\n        {memory.map((ep) => (\r\n          <option key={ep.id} value={ep.id}>\r\n            {ep.name.zh_CN} {ep.name.en_US ? `(${ep.name.en_US})` : ``}\r\n          </option>\r\n        ))}\r\n      </optgroup>\r\n    </Select>\r\n  );\r\n  return select;\r\n};\r\n\r\nconst SubEPSelector = (props) => {\r\n  const ep = props.ep;\r\n  const select = (\r\n    <Select value={props.value} onChange={props.selectIndex}>\r\n      <option value=\"\">Select Story</option>\r\n      {ep.story.map((story) => (\r\n        <option key={`${ep.id}_${story.index}`} value={story.index}>\r\n          {story.code ? `${story.code} : ` : ``} {story.name.zh_CN}{\" \"}\r\n          {story.name.en_US ? `(${story.name.en_US})` : ``}\r\n        </option>\r\n      ))}\r\n    </Select>\r\n  );\r\n  return select;\r\n};\r\n\r\nconst LanguageSelector = (props) => {\r\n  const choices = props.choices;\r\n  const lang_name = {\r\n    zh_CN: \"Chinese\",\r\n    en_US: \"English\",\r\n    ja_JP: \"Japanese\",\r\n    ko_KR: \"Korea\",\r\n    th_TH: \"Thai\",\r\n  };\r\n  const select = (\r\n    <Select value={props.value} onChange={props.selectLanguage}>\r\n      <option value=\"\">Select Language</option>\r\n      {choices.map((choice) => (\r\n        <option key={choice.sort} value={choice.sort}>\r\n          {lang_name[choice.language]}\r\n          {` (${choice.publisher})`}\r\n        </option>\r\n      ))}\r\n    </Select>\r\n  );\r\n\r\n  return select;\r\n};\r\n\r\nclass StorySelector extends React.PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      ep: ``,\r\n      index: ``,\r\n      language: ``,\r\n      publisher: ``,\r\n      id: ``,\r\n      choices: ``,\r\n    };\r\n  }\r\n\r\n  selectEP = (event) => {\r\n    this.setState({ ep: event.target.value, index: ``, id: `` });\r\n  };\r\n  selectIndex = (event) => {\r\n    this.setState({ index: event.target.value }, async () => {\r\n      if (event.target.value) {\r\n        var data = await Axios.get(\r\n          encodeURI(\r\n            `${this.props.backend}/story/${this.state.ep}/${this.state.index}`\r\n          )\r\n        );\r\n        if (data.data.length > 0) {\r\n          this.setState({ choices: data.data }, () => {\r\n            if (this.props.selected.publisher) {\r\n              this.setState({\r\n                id: data.data.find((c) => c.publisher === this.props.selected.publisher).sort,\r\n              });\r\n            }\r\n          });\r\n        }\r\n      }\r\n    });\r\n  };\r\n  selectLanguage = (event) => {\r\n    var choice = event.target.value;\r\n    if (choice) {\r\n      var story = this.state.choices.find((c) => c.sort === choice);\r\n      this.setState({\r\n        id: choice,\r\n        language: story.language,\r\n        publisher: story.publisher,\r\n      });\r\n    } else {\r\n      this.setState({ id: `` });\r\n    }\r\n  };\r\n\r\n  setSelect() {\r\n    this.setState(\r\n      {\r\n        ep: this.props.selected.ep || \"\",\r\n        index: this.props.selected.index || \"\",\r\n        language: this.props.selected.language || \"\",\r\n        publisher: this.props.selected.publisher || \"\",\r\n      },\r\n      async () => {\r\n        if (this.state.ep && this.state.index) {\r\n          var data = await Axios.get(\r\n            encodeURI(\r\n              `${this.props.backend}/story/${this.state.ep}/${this.state.index}`\r\n            )\r\n          );\r\n          if (data.data.length > 0) {\r\n            var choices = data.data;\r\n            var id = `${this.state.ep}_${this.state.index}_${this.state.language}_${this.state.publisher}`;\r\n            this.setState({ choices: choices, id: id });\r\n          }\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.setSelect();\r\n  }\r\n  componentDidUpdate(prevProps) {\r\n    if (this.props.selected !== prevProps.selected) {\r\n      this.setSelect();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <SelectorWindow>\r\n        <Background onClick={() => this.props.close()} />\r\n        <ContentBox>\r\n          <EPSelector\r\n            story_table={this.props.story_table}\r\n            value={this.state.ep}\r\n            selectEP={this.selectEP}\r\n          />\r\n          {this.state.ep ? (\r\n            <SubEPSelector\r\n              ep={this.props.story_table.find((ep) => ep.id === this.state.ep)}\r\n              value={this.state.index}\r\n              selectIndex={this.selectIndex}\r\n            />\r\n          ) : (\r\n            <></>\r\n          )}\r\n          {this.state.choices && this.state.index ? (\r\n            <LanguageSelector\r\n              choices={this.state.choices}\r\n              value={this.state.id}\r\n              selectLanguage={this.selectLanguage}\r\n            />\r\n          ) : (\r\n            <></>\r\n          )}\r\n          {this.state.id ? (\r\n            <SelectButton\r\n              onClick={() =>\r\n                this.props.selectStory({\r\n                  story_ep: this.state.ep,\r\n                  story_index: this.state.index,\r\n                  story_language: this.state.language,\r\n                  id: this.state.id,\r\n                  publisher: this.state.publisher,\r\n                })\r\n              }\r\n            >\r\n              Select\r\n            </SelectButton>\r\n          ) : (\r\n            <></>\r\n          )}\r\n        </ContentBox>\r\n      </SelectorWindow>\r\n    );\r\n  }\r\n}\r\n\r\nexport default StorySelector;\r\n","import React from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\n\r\nconst MainDisplay = styled.div`\r\n  max-width: 60rem;\r\n  margin: auto;\r\n  background-color: #484848;\r\n`;\r\nconst DescriptionBlock = styled.div`\r\n  margin: 1rem;\r\n  padding: 1rem;\r\n  border: solid black;\r\n  border-width: 0 8px 0 8px;\r\n  color: #ffffff;\r\n  background-color: #212121;\r\n`;\r\n\r\nconst DialogBlock = styled.div`\r\n  color: #ffffff;\r\n  margin: 1rem 0;\r\n`;\r\n\r\nconst DialogName = styled.div`\r\n  padding: 1rem;\r\n  background-color: #212121;\r\n  font-weight: 700;\r\n  width: fit-content;\r\n  cursor: pointer;\r\n  user-select: none;\r\n`;\r\nconst DialogText = styled.div`\r\n  padding: 0 1rem;\r\n`;\r\n\r\nconst DecisionBlock = styled.div`\r\n  display: flex;\r\n  justify-content: space-around;\r\n  margin: 1rem 0;\r\n`;\r\n\r\nconst DecisionButton = styled.div`\r\n  background-color: white;\r\n  display: flex;\r\n  padding: 1rem;\r\n  margin: 0 1rem;\r\n  align-items: center;\r\n  cursor: pointer;\r\n  user-select: none;\r\n  ${(props) =>\r\n    props.selected &&\r\n    css`\r\n      background-color: #212121;\r\n      color: white;\r\n    `}\r\n`;\r\n\r\nconst BackgroundImage = styled.img`\r\n  width: 100%;\r\n  height: auto;\r\n`;\r\n\r\nconst Description = (props) => {\r\n  const lines = props.lines;\r\n  const result = (\r\n    <DescriptionBlock key={props.lines_nums}>\r\n      {lines.map((line) => (\r\n        <p key={line.index}>{line.text}</p>\r\n      ))}\r\n    </DescriptionBlock>\r\n  );\r\n  return result;\r\n};\r\n\r\nconst Dialog = (props) => {\r\n  const lines = props.lines;\r\n  const result = (\r\n    <DialogBlock key={props.lines_nums}>\r\n      <DialogName onClick={() => props.selectChar(props.char)}>\r\n        {props.name || `???`}\r\n      </DialogName>\r\n      <DialogText>\r\n        {lines.map((line) => (\r\n          <p key={line.index}>{line.text}</p>\r\n        ))}\r\n      </DialogText>\r\n    </DialogBlock>\r\n  );\r\n  return result;\r\n};\r\n\r\nconst Decision = (props) => {\r\n  const line = props.line;\r\n  const index = props.index;\r\n  const result = (\r\n    <DecisionBlock key={index}>\r\n      {line.params.options.map((option, i) => (\r\n        <DecisionButton\r\n          key={`${props.index}_${line.params.values[i]}`}\r\n          onClick={() =>\r\n            props.select({ line: props.index, option: line.params.values[i] })\r\n          }\r\n          selected={props.selected === line.params.values[i]}\r\n        >\r\n          {option}\r\n        </DecisionButton>\r\n      ))}\r\n    </DecisionBlock>\r\n  );\r\n  return result;\r\n};\r\n\r\nclass Disply extends React.PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      decision: {},\r\n      story: [],\r\n    };\r\n  }\r\n  decide = (params) => {\r\n    var decision = this.state.decision;\r\n    decision[params.line] = params.option;\r\n    this.setState({ decision: decision }, () => this.prepare());\r\n  };\r\n  selectChar = (char) => {\r\n    this.props.selectChar(char);\r\n  };\r\n  prepare = () => {\r\n    var result = [];\r\n    var decision = this.state.decision;\r\n    var background = \"bg_black\";\r\n    var char_img = \"\";\r\n    const story = this.props.story;\r\n    for (var i = 0; i < story.length; i++) {\r\n      var line = story[i];\r\n      switch (line.tag) {\r\n        case `BACKGROUND`:\r\n          if (line.params?.image) {\r\n            result.push(\r\n              <BackgroundImage\r\n                key={i}\r\n                src={`./images/backgrounds/${line.params.image}.png`}\r\n              ></BackgroundImage>\r\n            );\r\n          } else {\r\n            result.push(\r\n              <BackgroundImage\r\n                key={i}\r\n                src={`./images/backgrounds/bg_black.png`}\r\n              ></BackgroundImage>\r\n            );\r\n          }\r\n          background = line?.params?.image || \"bg_black\";\r\n          break;\r\n        case `IMAGE`:\r\n          if (line.params?.image) {\r\n            result.push(\r\n              <BackgroundImage\r\n                key={i}\r\n                src={`./images/images/${line.params.image}.png`}\r\n              ></BackgroundImage>\r\n            );\r\n          } else {\r\n            result.push(\r\n              <BackgroundImage\r\n                key={i}\r\n                src={`./images/backgrounds/${background}.png`}\r\n              ></BackgroundImage>\r\n            );\r\n          }\r\n          break;\r\n        case `DIALOG`:\r\n          if (line.params?.text) {\r\n            var lines = [{ index: i, text: line.params.text }];\r\n            var lines_nums = [i];\r\n            var j = i + 1;\r\n            while (\r\n              story[j].tag === `DIALOG` &&\r\n              story[j]?.params?.name === line.params.name\r\n            ) {\r\n              lines.push({ index: j, text: story[j].params.text });\r\n              lines_nums.push(j);\r\n              j += 1;\r\n            }\r\n            result.push(\r\n              <Dialog\r\n                key={i}\r\n                lines={lines}\r\n                name={line.params.name}\r\n                lines_nums={lines_nums.join(`;`)}\r\n                char={char_img}\r\n                selectChar={(char) => this.selectChar(char)}\r\n              ></Dialog>\r\n            );\r\n            if(story[j]?.params?.name !== line.params.name){\r\n              char_img = \"\"\r\n            }\r\n            i = j - 1;\r\n          }\r\n          break;\r\n        case `DESCRIPTION`:\r\n          lines = [{ index: i, text: line.params.text }];\r\n          j = i + 1;\r\n          var desc_id = [i];\r\n          while (story[j].tag === `DESCRIPTION`) {\r\n            lines.push({ index: j, text: story[j].params.text });\r\n            desc_id.push(j);\r\n            j += 1;\r\n          }\r\n          result.push(\r\n            <Description\r\n              key={i}\r\n              lines={lines}\r\n              lines_nums={desc_id.join(\";\")}\r\n            ></Description>\r\n          );\r\n          i = j - 1;\r\n          break;\r\n        case `DECISION`:\r\n          if (!decision[i]) {\r\n            decision[i] = line.params.values[0];\r\n          }\r\n          decision.last = decision[i];\r\n          result.push(\r\n            <Decision\r\n              key={i}\r\n              line={line}\r\n              index={i}\r\n              selected={decision[i]}\r\n              select={(params) => this.decide(params)}\r\n            ></Decision>\r\n          );\r\n          break;\r\n        case `PREDICATE`:\r\n          var references = line.params.references;\r\n          if (!references.includes(decision.last)) {\r\n            var next = i + 1;\r\n            while (\r\n              story[next].tag !== `PREDICATE` &&\r\n              !story[next].params?.references?.includes(decision.last)\r\n            ) {\r\n              next += 1;\r\n            }\r\n            i = next - 1;\r\n          }\r\n          break;\r\n        case `CHARACTER`:\r\n          if (line.params) {\r\n            if (line.params.focus) {\r\n              switch (line.params.focus) {\r\n                case \"1\":\r\n                  char_img = line.params.name;\r\n                  break;\r\n                case \"2\":\r\n                  char_img = line.params.name2;\r\n                  break;\r\n                default:\r\n                  char_img = \"\";\r\n                  break;\r\n              }\r\n            } else {\r\n              char_img = line.params.name;\r\n            }\r\n          } else {\r\n            char_img = \"\";\r\n          }\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n    this.setState({ story: result, decision: decision });\r\n  };\r\n\r\n  componentDidMount() {\r\n    if (this.props.story) {\r\n      this.prepare();\r\n    }\r\n  }\r\n  componentDidUpdate(prevProps) {\r\n    if (this.props.story !== prevProps.story) {\r\n      this.prepare();\r\n    } else {\r\n      if (!this.state.story) {\r\n        this.prepare();\r\n      }\r\n    }\r\n  }\r\n  render() {\r\n    return (\r\n      <MainDisplay>\r\n        {this.state.story ? this.state.story.map((line) => line) : <></>}\r\n      </MainDisplay>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Disply;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport SpriteHub from \"../../lib/sprite_list.json\";\r\nimport mergeImages from \"merge-images\";\r\nimport { useEffect,useState } from \"react\";\r\n\r\nconst Background = styled.div`\r\n  height: 100vh;\r\n  width: 100vw;\r\n  top: 0;\r\n  left: 0;\r\n  position: fixed;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  cursor: pointer;\r\n`;\r\nconst CharImage = styled.img`\r\n  width: auto;\r\n  height: 80%;\r\n`;\r\n\r\nfunction CharacterImage(props) {\r\n  const [src,setSrc] = useState(\"\")\r\n\r\n  useEffect(()=>{\r\n    var num = \"1\"\r\n    var name = \"\"\r\n    if (props.char.split(\"#\").length > 1) {\r\n      [name,num] = props.char.split(\"#\");\r\n    } else {\r\n      name = props.char.split(\"#\")[0];\r\n    }\r\n    var char = SpriteHub[name]\r\n    if (\r\n      char[\"FacePos\"][\"x\"] > 0 &&\r\n      char[\"FacePos\"][\"y\"] > 0\r\n    ) {\r\n      var base = Object.keys(char.sprites)[Object.keys(char.sprites).length - 1];\r\n      var img = new Image()\r\n      img.src = `./images/characters/${name}/${char[\"sprites\"][num][\"sprite\"]}`\r\n      img.onload = function(){\r\n        var canvas = document.createElement(\"canvas\")\r\n        var ctx = canvas.getContext(\"2d\")\r\n        ctx.drawImage(img,0,0,char.FaceSize.x,char.FaceSize.y)\r\n        var src = canvas.toDataURL(\"image/png\")\r\n        mergeImages([\r\n          {\r\n            src: `./images/characters/${name}/${char[\"sprites\"][base][\"sprite\"]}`,\r\n            x: 0,\r\n            y: 0,\r\n          },\r\n          {\r\n            src: src,\r\n            x: char.FacePos.x,\r\n            y: char.FacePos.y,\r\n          },\r\n        ]).then(result=>{\r\n          setSrc(result)\r\n        })\r\n      }\r\n    } else {\r\n      var sprite = \"\"\r\n      if(SpriteHub[name][\"sprites\"][num]?.sprite){\r\n        sprite = SpriteHub[name][\"sprites\"][num]?.sprite;\r\n      } else {\r\n        if(SpriteHub[name][\"sprites\"][\"1\"]?.sprite){\r\n          sprite = SpriteHub[name][\"sprites\"][\"1\"]?.sprite;\r\n        } else {\r\n          name = \"char_empty\"\r\n          sprite = \"char_empty.png\"\r\n        }\r\n      }\r\n      setSrc (`./images/characters/${name}/${sprite}`);\r\n    }\r\n  },[props.char,src])\r\n\r\n  return (\r\n    <Background onClick={() => props.close()}>\r\n      <CharImage src={`${src}`}></CharImage>\r\n    </Background>\r\n  );\r\n}\r\n\r\nexport default CharacterImage;\r\n","function replace(source, translated) {\r\n  const tagRE = /\\[(?<tag>.+?)\\((?<params>.*)\\)\\]/;\r\n  const dialogRE = /\\[[Nn]ame=\"(?<name>.*)\"\\](?<text>.*)/;\r\n  const decisionRE = /\\[[dD]ecision\\(options=\"(?<options>.*)\"[,|, ]+values=\"(?<values>.*)\"\\)\\]/;\r\n  const blankRE = /\\[(?<tag>.*)\\]/;\r\n  var counter = {};\r\n\r\n  const lines = source.split(`\\n`);\r\n  for (var tag in translated.data) {\r\n    if (translated.data[tag]) {\r\n      counter[tag] = 0;\r\n    }\r\n  }\r\n\r\n  return lines.map((line) => {\r\n    var obj = {};\r\n    if (line.match(tagRE)) {\r\n      var { tag, params } = line.match(tagRE).groups;\r\n      tag = tag.toUpperCase();\r\n      if (tag === `DECISION`) {\r\n        params = line.match(decisionRE).groups;\r\n        for (let key in params) {\r\n          params[key] = params[key].split(`;`).map((v) => v.trim());\r\n        }\r\n      } else {\r\n        var temp = {};\r\n        params = params.split(`,`);\r\n        if (params.length > 0) {\r\n          params.forEach((param) => {\r\n            param = param.trim();\r\n            if (param.split(`=`).length > 1) {\r\n              var [key, value] = param.split(`=`);\r\n              temp[key] = value.replace(/\"/g, ``);\r\n            }\r\n          });\r\n        }\r\n        params = temp;\r\n        if(tag === `PREDICATE`){\r\n          params.references = params.references.split(';')\r\n        }\r\n      }\r\n      obj = { tag: tag, params: params };\r\n    } else {\r\n      if (line.match(dialogRE)) {\r\n        var { name, text } = line.match(dialogRE).groups;\r\n        if (text.length > 1 && text[0] === \" \") text = text.trim();\r\n        obj = {\r\n          tag: `DIALOG`,\r\n          params: {\r\n            name: name.toUpperCase(),\r\n            text: text,\r\n          },\r\n        };\r\n      } else {\r\n        if (line.match(blankRE)) {\r\n          tag = line.match(blankRE).groups.tag;\r\n          tag = tag.toUpperCase();\r\n          obj = { tag: tag };\r\n        } else {\r\n          if (line.search(\"//\") && line.length > 1 && line[0] !== `[`) {\r\n            obj = {\r\n              tag: `DESCRIPTION`,\r\n              params: {\r\n                text: line,\r\n              },\r\n            };\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (obj.tag in translated.data) {\r\n      if (obj.params) {\r\n        if(obj.tag === `DIALOG`){\r\n          if(obj.params.text){\r\n            obj.params = {\r\n              ...obj.params,\r\n              ...translated.data[obj.tag][counter[obj.tag]].params,\r\n            };\r\n            counter[obj.tag] += 1;\r\n          }\r\n        } else {\r\n          obj.params = {\r\n            ...obj.params,\r\n            ...translated.data[obj.tag][counter[obj.tag]].params,\r\n          };\r\n          counter[obj.tag] += 1;\r\n        }\r\n      }\r\n    }\r\n    return obj;\r\n  });\r\n}\r\nexport default replace","import Axios from \"axios\";\r\nimport React from \"react\";\r\nimport StorySelector from \"./Components/Reader/StorySelector\";\r\nimport Display from \"./Components/Reader/Display\";\r\nimport CharacterImage from \"./Components/Reader/CharacterImage\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport styled from \"styled-components\";\r\nimport replace from \"./lib/replace\";\r\n\r\nconst Home = styled.div`\r\n  background-color: #484848;\r\n  color: white;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n`;\r\n\r\nconst Main = styled.div`\r\n  background-color: #212121;\r\n`;\r\nconst Nav = styled.div`\r\n  position: fixed;\r\n  top: 0;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);\r\n  background-color: #212121;\r\n  color: #ffffff;\r\n  width: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  height: 64px;\r\n  padding: 0 16px;\r\n`;\r\nconst NavItems = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding-right: 2rem;\r\n  width: 100%;\r\n`;\r\nconst NavItem = styled.div`\r\n  font-size: 1rem;\r\n  cursor: pointer;\r\n`;\r\nconst Content = styled.div`\r\n  padding-top: 64px;\r\n  overflow-y: auto;\r\n  overflow-x: hidden;\r\n`;\r\n\r\nconst backend =\r\n  process.env.NODE_ENV === \"production\"\r\n    ? \"https://5s8czbe2jd.execute-api.ap-southeast-1.amazonaws.com\"\r\n    : \"http://localhost:8080\";\r\nconst assets =\r\n  process.env.NODE_ENV === \"production\"\r\n    ? \"https://autoonez.github.io/ak-story/\"\r\n    : \"http://localhost:3000\";\r\n\r\nclass Reader extends React.PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      lang: \"\",\r\n      ep: \"\",\r\n      sIndex: \"\",\r\n      publisher: \"\",\r\n      story_data: {},\r\n      story_table: [],\r\n      char_img: \"\",\r\n      story: false,\r\n      storyselector: false,\r\n      redirect: false,\r\n      redirect_search: \"\",\r\n    };\r\n  }\r\n  getUrlParams() {\r\n    const search = this.props.location.search;\r\n    const urlParams = new URLSearchParams(search);\r\n    const params = {\r\n      lang: urlParams.get(\"lang\"),\r\n      ep: urlParams.get(\"ep\"),\r\n      sIndex: urlParams.get(\"sIndex\"),\r\n      publisher: urlParams.get(\"publisher\"),\r\n    };\r\n    this.setState(\r\n      {\r\n        lang: params.lang,\r\n        ep: params.ep,\r\n        sIndex: params.sIndex,\r\n        publisher: params.publisher,\r\n      },\r\n      () => {\r\n        this.getStoryList();\r\n      }\r\n    );\r\n  }\r\n  getStoryData = async () => {\r\n    var data = await Axios.get(\r\n      encodeURI(\r\n        `${backend}/story/${this.state.ep}/${this.state.sIndex}/${\r\n          this.state.lang\r\n        }/${this.state.publisher.replace(/\\s/g, \"--\")}`\r\n      )\r\n    );\r\n    if (data.status === 200) {\r\n      var file = \"\";\r\n      this.state.story_table.forEach((ep) => {\r\n        if (ep.id === this.state.ep) {\r\n          ep.story.forEach((s) => {\r\n            if (String(s.index) === String(this.state.sIndex)) {\r\n              file = s.file;\r\n            }\r\n          });\r\n        }\r\n      });\r\n\r\n      const ts = data.data;\r\n      const data_source = await Axios.get(\r\n        encodeURI(`${assets}/story/${file}.txt`)\r\n      );\r\n      const source = data_source.data;\r\n      const story_data = replace(source, ts);\r\n      this.setState({ story_data: story_data, story: true }, () => {\r\n        window.scrollTo(0, 0);\r\n      });\r\n    } else {\r\n      this.setState({ storyselector: true });\r\n    }\r\n  };\r\n  getStoryList = async () => {\r\n    if (this.state.story_table.length === 0) {\r\n      var data = await Axios.get(encodeURI(`${backend}/story`));\r\n      if (data.data?.length > 0) {\r\n        const re = /act(?<act>[0-9]{1,2})d(?<d>[0-9])/;\r\n        var sorted = data.data.sort((a, b) => {\r\n          if (a.type === b.type) {\r\n            if (a.id.match(re) && b.id.match(re)) {\r\n              var name_a = a.id.match(re).groups;\r\n              name_a.act = parseInt(name_a.act);\r\n              name_a.d = parseInt(name_a.d);\r\n              var name_b = b.id.match(re).groups;\r\n              name_b.act = parseInt(name_b.act);\r\n              name_b.d = parseInt(name_b.d);\r\n              if (name_a.act === name_b.act) {\r\n                if (name_a.d < name_b.d) {\r\n                  return -1;\r\n                }\r\n                if (name_a.d > name_b.d) {\r\n                  return 1;\r\n                }\r\n              } else {\r\n                if (name_a.act < name_b.act) {\r\n                  return -1;\r\n                }\r\n                if (name_a.act > name_b.act) {\r\n                  return 1;\r\n                }\r\n              }\r\n            } else {\r\n              if (a.id < b.id) {\r\n                return -1;\r\n              }\r\n              if (a.id > b.id) {\r\n                return 1;\r\n              }\r\n              return 0;\r\n            }\r\n          } else {\r\n            if (a.type > b.type) {\r\n              return -1;\r\n            }\r\n            if (a.type < b.type) {\r\n              return 1;\r\n            }\r\n          }\r\n          return 0;\r\n        });\r\n        this.setState({ story_table: sorted });\r\n      }\r\n    }\r\n    if (\r\n      this.state.ep &&\r\n      this.state.sIndex &&\r\n      this.state.lang &&\r\n      this.state.publisher\r\n    ) {\r\n      this.getStoryData();\r\n    }\r\n  };\r\n  selectStory = (story) => {\r\n    this.setState({\r\n      lang: story.story_language,\r\n      ep: story.story_ep,\r\n      sIndex: story.story_index,\r\n      publisher: story.publisher,\r\n      storyselector: false,\r\n      story: true,\r\n      redirect: true,\r\n      redirect_search: `?ep=${story.story_ep}&sIndex=${story.story_index}&lang=${story.story_language}&publisher=${story.publisher}`,\r\n    });\r\n  };\r\n\r\n  showCharImage = (char) => {\r\n    this.setState({ char_img: char });\r\n  };\r\n  componentDidMount() {\r\n    this.getUrlParams();\r\n  }\r\n  componentDidUpdate(prevProps) {\r\n    if (this.props.location.search !== prevProps.location.search) {\r\n      this.getUrlParams();\r\n    }\r\n    this.setState({ redirect: false });\r\n  }\r\n  render() {\r\n    return (\r\n      <Main>\r\n        <Nav>\r\n          <NavItems>\r\n            <NavItem\r\n              onClick={() =>\r\n                this.setState({\r\n                  redirect: true,\r\n                  redirect_search: \"\",\r\n                  story: false,\r\n                })\r\n              }\r\n            >\r\n              Arknights Story Reader\r\n            </NavItem>\r\n            <NavItem onClick={() => this.setState({ storyselector: true })}>\r\n              <i className=\"fas fa-bars\"></i>\r\n            </NavItem>\r\n          </NavItems>\r\n        </Nav>\r\n        <Content>\r\n          {this.state.story ? (\r\n            <Display\r\n              story={this.state.story_data}\r\n              selectChar={(char) => this.showCharImage(char)}\r\n            />\r\n          ) : (\r\n            <Home>\r\n              <div>\r\n                <p>Arknights Story Reader (Fan Made)</p>\r\n                <p>Made by Discord: IchiKung#6130</p>\r\n              </div>\r\n            </Home>\r\n          )}\r\n        </Content>\r\n        {this.state.storyselector ? (\r\n          <StorySelector\r\n            backend={backend}\r\n            story_table={this.state.story_table}\r\n            selectStory={(story) => this.selectStory(story)}\r\n            selected={{\r\n              ep: this.state.ep,\r\n              index: this.state.sIndex,\r\n              language: this.state.lang,\r\n              publisher: this.state.publisher,\r\n            }}\r\n            close={() => this.setState({ storyselector: false })}\r\n          ></StorySelector>\r\n        ) : (\r\n          <></>\r\n        )}\r\n        {this.state.redirect ? (\r\n          <Redirect\r\n            to={{\r\n              pathname: \"/reader\",\r\n              search: this.state.redirect_search,\r\n            }}\r\n          />\r\n        ) : (\r\n          <></>\r\n        )}\r\n        {this.state.char_img ? (\r\n          <CharacterImage\r\n            char={this.state.char_img.toLowerCase()}\r\n            close={() => this.setState({ char_img: \"\" })}\r\n          ></CharacterImage>\r\n        ) : (\r\n          <></>\r\n        )}\r\n      </Main>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Reader;\r\n","import React from \"react\";\r\n\r\nclass Editor extends React.PureComponent {\r\n  render() {\r\n    return <div>Editor</div>;\r\n  }\r\n}\r\n\r\nexport default Editor;\r\n","import { useEffect, useState } from \"react\";\r\nimport styled, { css } from \"styled-components\";\r\nimport mergeImages from \"merge-images\";\r\n\r\nconst skins_list = require(\"./lib/skin_list.json\");\r\nconst chars_list = require(\"./lib/sprite_list.json\");\r\nconst images_list = require(\"./lib/images.json\");\r\n\r\nconst Background = styled.div`\r\n  background: #484848;\r\n  width: 100%;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nconst CatBackground = styled.div`\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 1rem;\r\n  overflow: hidden;\r\n`;\r\n\r\nconst CatSearch = styled.div`\r\n  margin-bottom: 1rem;\r\n  background: #212121;\r\n  padding: 1rem;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  flex-direction: column;\r\n`;\r\n\r\nconst SearchBox = styled.input`\r\n  width: 100%;\r\n`;\r\n\r\nconst CatBody = styled.div`\r\n  height: 100%;\r\n  padding: 1rem;\r\n  background: #212121;\r\n  overflow: hidden;\r\n`;\r\n\r\nconst Nav = styled.div`\r\n  background: #212121;\r\n  width: 100%;\r\n`;\r\n\r\nconst NavContainer = styled.div`\r\n  padding: 1rem;\r\n  display: flex;\r\n  justify-content: space-around;\r\n`;\r\n\r\nconst NavButton = styled.div`\r\n  color: white;\r\n  user-select: none;\r\n  cursor: pointer;\r\n  padding: 0.25rem;\r\n\r\n  ${(props) =>\r\n    props.primary &&\r\n    css`\r\n      background: white;\r\n      color: black;\r\n    `}\r\n`;\r\n\r\nconst BackgroundImage = styled.img`\r\n  width: auto;\r\n  height: auto;\r\n  max-width: 256px;\r\n  max-height: 144px;\r\n  margin: 0.25rem;\r\n`;\r\n\r\nconst CatContent = styled.div`\r\n  height: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  flex-wrap: wrap;\r\n  overflow: auto;\r\n`;\r\n\r\nconst CharCard = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  text-align: center;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin: 0.25rem;\r\n  background: #484848;\r\n  color: white;\r\n  padding: 0.25rem;\r\n  cursor: pointer;\r\n`;\r\n\r\nconst CharImg = styled.img`\r\n  width: auto;\r\n  height: auto;\r\n  max-height: 240px;\r\n  max-width: 240px;\r\n`;\r\n\r\nconst BackButton = styled.div`\r\n  padding: 0.25rem;\r\n  margin-top: 1rem;\r\n  background: white;\r\n  color: black;\r\n  width: 50%;\r\n  text-align: center;\r\n  cursor: pointer;\r\n`;\r\n\r\nfunction Operators() {\r\n  const [search, setSearch] = useState(\"\");\r\n  const [op, setOP] = useState(\"\");\r\n  const skinName = (skin) => {\r\n    switch (skin.skinGroupId) {\r\n      case `ILLUST_0`:\r\n        return `Elite 0`;\r\n      case `ILLUST_2`:\r\n        return `Elite 2`;\r\n      default:\r\n        return `${skin.skinName} (${skin.skinGroupId} : ${skin.skinGroupName})`;\r\n    }\r\n  };\r\n  return (\r\n    <CatBackground>\r\n      <CatSearch>\r\n        <SearchBox\r\n          type={`text`}\r\n          onInput={(e) => setSearch(e.target.value)}\r\n        ></SearchBox>\r\n        {op ? <BackButton onClick={() => setOP(\"\")}>Back</BackButton> : <></>}\r\n      </CatSearch>\r\n      <CatBody>\r\n        <CatContent>\r\n          {op\r\n            ? skins_list[op][\"skins\"].map((s) => (\r\n                <a\r\n                  href={`./images/skins/${s.skinId}.png`}\r\n                  target=\"_blank\"\r\n                  rel=\"noopener noreferrer\"\r\n                  key={s.skinId}\r\n                >\r\n                  <CharCard>\r\n                    <CharImg src={`./images/skins/${s.skinId}.png`}></CharImg>\r\n                    <div>{skinName(s)}</div>\r\n                  </CharCard>\r\n                </a>\r\n              ))\r\n            : search\r\n            ? Object.keys(skins_list)\r\n                .filter(\r\n                  (c) =>\r\n                    skins_list[c][\"charId\"]\r\n                      .toLowerCase()\r\n                      .search(search.toLowerCase()) >= 0 ||\r\n                    skins_list[c][\"charName\"]\r\n                      .toLowerCase()\r\n                      .search(search.toLowerCase()) >= 0\r\n                )\r\n                .map((c) => (\r\n                  <CharCard key={c} onClick={() => setOP(c)}>\r\n                    <CharImg\r\n                      src={`./images/skins/${skins_list[c][\"skins\"][0][\"skinId\"]}.png`}\r\n                    ></CharImg>\r\n                    <div>{`${skins_list[c][\"charId\"]} (${skins_list[c][\"charName\"]})`}</div>\r\n                  </CharCard>\r\n                ))\r\n            : Object.keys(skins_list).map((c) => (\r\n                <CharCard key={c} onClick={() => setOP(c)}>\r\n                  <CharImg\r\n                    src={`./images/skins/${skins_list[c][\"skins\"][0][\"skinId\"]}.png`}\r\n                  ></CharImg>\r\n                  <div>{`${skins_list[c][\"charId\"]} (${skins_list[c][\"charName\"]})`}</div>\r\n                </CharCard>\r\n              ))}\r\n        </CatContent>\r\n      </CatBody>\r\n    </CatBackground>\r\n  );\r\n}\r\n\r\nfunction Characters() {\r\n  const [search, setSearch] = useState(\"\");\r\n  const [char, setChar] = useState(\"\");\r\n  const [images, setImages] = useState([]);\r\n\r\n  const getImageSrc = async (c_name, n) => {\r\n    const c = chars_list[c_name];\r\n    if (c.FacePos.x >= 0 && c.FacePos.y >= 0) {\r\n      var base = Object.keys(c.sprites)[Object.keys(c.sprites).length - 1];\r\n      if (base === Object.keys(c.sprites).length) {\r\n        return `./images/characters/${c_name}/${c[\"sprites\"][base]}`;\r\n      } else {\r\n        return await mergeImages([\r\n          {\r\n            src: `./images/characters/${c_name}/${c[\"sprites\"][base][\"sprite\"]}`,\r\n            x: 0,\r\n            y: 0,\r\n          },\r\n          {\r\n            src: `./images/characters/${c_name}/${c[\"sprites\"][n][\"sprite\"]}`,\r\n            x: c.FacePos.x,\r\n            y: c.FacePos.y,\r\n          },\r\n        ]);\r\n      }\r\n    } else {\r\n      return `./images/characters/${c_name}/${c[\"sprites\"][n][\"sprite\"]}`;\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    var promises = \"\";\r\n\r\n    if (char) {\r\n      var sprites = chars_list[char][\"sprites\"];\r\n      setImages(\r\n        Object.keys(sprites).map((s) => (\r\n          <a\r\n            href={`./images/characters/${char}/${sprites[s][\"sprite\"]}`}\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n            key={`${char}_${s}`}\r\n          >\r\n            <CharCard>\r\n              <CharImg\r\n                src={`./images/characters/${char}/${sprites[s][\"sprite\"]}`}\r\n              ></CharImg>\r\n              <div>\r\n                {chars_list[char][\"FacePos\"][\"x\"] > 0 &&\r\n                chars_list[char][\"FacePos\"][\"y\"] > 0 &&\r\n                Object.keys(sprites)[Object.keys(sprites).length - 1] === s\r\n                  ? `base`\r\n                  : `${s} ${sprites[s][\"alias\"]}`}\r\n              </div>\r\n            </CharCard>\r\n          </a>\r\n        ))\r\n      );\r\n    } else {\r\n      if (search) {\r\n        promises = Object.keys(chars_list)\r\n          .filter((s) => s.search(search) >= 0)\r\n          .map(async (c) => {\r\n            const src = await getImageSrc(c, 1);\r\n            return (\r\n              <CharCard onClick={() => setChar(c)} key={c}>\r\n                <CharImg src={src}></CharImg>\r\n                <div>{c}</div>\r\n              </CharCard>\r\n            );\r\n          });\r\n      } else {\r\n        promises = Object.keys(chars_list).map(async (c) => {\r\n          const src = await getImageSrc(c, 1);\r\n          return (\r\n            <CharCard onClick={() => setChar(c)} key={c}>\r\n              <CharImg src={src}></CharImg>\r\n              <div>{c}</div>\r\n            </CharCard>\r\n          );\r\n        });\r\n      }\r\n      Promise.all(promises).then((result) => {\r\n        setImages(result);\r\n      });\r\n    }\r\n  }, [search, char]);\r\n  return (\r\n    <CatBackground>\r\n      <CatSearch>\r\n        <SearchBox\r\n          type={`text`}\r\n          onInput={(e) => setSearch(e.target.value)}\r\n        ></SearchBox>\r\n        {char ? (\r\n          <BackButton onClick={() => setChar(\"\")}>Back</BackButton>\r\n        ) : (\r\n          <></>\r\n        )}\r\n      </CatSearch>\r\n      <CatBody>\r\n        <CatContent>{images.map((image) => image)}</CatContent>\r\n      </CatBody>\r\n    </CatBackground>\r\n  );\r\n}\r\n\r\nfunction Backgrounds(props) {\r\n  const [search, setSearch] = useState(\"\");\r\n  const images =\r\n    props.type === \"backgrounds\" ? images_list.backgrounds : images_list.images;\r\n  return (\r\n    <CatBackground>\r\n      <CatSearch>\r\n        <SearchBox\r\n          type={`text`}\r\n          onInput={(e) => setSearch(e.target.value)}\r\n        ></SearchBox>\r\n      </CatSearch>\r\n      <CatBody>\r\n        <CatContent>\r\n          {search\r\n            ? images\r\n                .filter((i) => i.search(search) >= 0)\r\n                .map((bg) => (\r\n                  <a\r\n                    href={`./images/${props.type}/${bg}`}\r\n                    target=\"_blank\"\r\n                    rel=\"noopener noreferrer\"\r\n                    key={bg}\r\n                  >\r\n                    <BackgroundImage\r\n                      src={`./images/${props.type}/${bg}`}\r\n                      alt={bg}\r\n                    />\r\n                  </a>\r\n                ))\r\n            : images.map((bg) => (\r\n                <a\r\n                  href={`./images/${props.type}/${bg}`}\r\n                  target=\"_blank\"\r\n                  rel=\"noopener noreferrer\"\r\n                  key={bg}\r\n                >\r\n                  <BackgroundImage\r\n                    src={`./images/${props.type}/${bg}`}\r\n                    alt={bg}\r\n                  />\r\n                </a>\r\n              ))}\r\n        </CatContent>\r\n      </CatBody>\r\n    </CatBackground>\r\n  );\r\n}\r\n\r\nfunction Images() {\r\n  const [cat, setCat] = useState(\"\");\r\n  return (\r\n    <Background>\r\n      <Nav>\r\n        <NavContainer>\r\n          <NavButton\r\n            primary={cat === \"operators\"}\r\n            onClick={() => setCat(\"operators\")}\r\n          >\r\n            Operators\r\n          </NavButton>\r\n          <NavButton\r\n            primary={cat === \"characters\"}\r\n            onClick={() => setCat(\"characters\")}\r\n          >\r\n            Characters\r\n          </NavButton>\r\n          <NavButton\r\n            primary={cat === \"backgrounds\"}\r\n            onClick={() => setCat(\"backgrounds\")}\r\n          >\r\n            Backgrounds\r\n          </NavButton>\r\n          <NavButton\r\n            primary={cat === \"images\"}\r\n            onClick={() => setCat(\"images\")}\r\n          >\r\n            Images\r\n          </NavButton>\r\n        </NavContainer>\r\n      </Nav>\r\n      {cat === `backgrounds` ? <Backgrounds type=\"backgrounds\" /> : <></>}\r\n      {cat === `images` ? <Backgrounds type=\"images\" /> : <></>}\r\n      {cat === `characters` ? <Characters /> : <></>}\r\n      {cat === `operators` ? <Operators /> : <></>}\r\n    </Background>\r\n  );\r\n}\r\n\r\nexport default Images;\r\n","import { HashRouter, Switch, Route } from \"react-router-dom\";\nimport Home from \"./Home\";\nimport Reader from \"./Reader\";\nimport Editor from \"./Editor\";\nimport Images from \"./Images\";\n\nfunction App() {\n  return (\n    <HashRouter basename={process.env.PUBLIC_URL}>\n      <Switch>\n        <Route exact path={\"/\"} component={Home} />\n        <Route exact path=\"/reader\" component={Reader} />\n        <Route exact path=\"/editor\" component={Editor} />\n        <Route exact path=\"/images\" component={Images} />\n      </Switch>\n    </HashRouter>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}